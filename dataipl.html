<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Tampilkan Data Google Sheets dengan PapaParse</title>
</head>
<body>
  <h2>Data dari Google Sheets (PapaParse)</h2>
  <table id="data-table" border="1" cellpadding="5" cellspacing="0">
    <thead></thead>
    <tbody></tbody>
  </table>

  <!-- Load PapaParse dari CDN -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRQBSWp7dBKus6wO8G-vBtSW9ZpKlRbmNLbXsaWQZeaQU_ZEY9p9EujIGTyIPVzb5cgVTlq9d0Lf29P/pub?gid=186945041&single=true&output=csv';

    fetch(csvUrl)
      .then(response => response.text())
      .then(csvText => {
        // Parse CSV pakai PapaParse
        const results = Papa.parse(csvText, {
          header: false,
          skipEmptyLines: true
        });

        // Ambil data array 2D
        const data = results.data;

        // Render tabel
        renderTable(data);
      })
      .catch(err => {
        console.error('Gagal ambil atau parse CSV:', err);
        document.body.innerHTML += '<p>Gagal mengambil data.</p>';
      });

    function renderTable(data) {
      const thead = document.querySelector('#data-table thead');
      const tbody = document.querySelector('#data-table tbody');

      thead.innerHTML = '';
      tbody.innerHTML = '';

      // Header (baris pertama)
      const headerRow = document.createElement('tr');
      data[0].forEach(headerText => {
        const th = document.createElement('th');
        th.textContent = headerText;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      // Body (baris selanjutnya)
      for(let i = 1; i < data.length; i++) {
        const row = document.createElement('tr');
        data[i].forEach(cellText => {
          const td = document.createElement('td');
          td.textContent = cellText;
          row.appendChild(td);
        });
        tbody.appendChild(row);
      }
    }
  </script>
</body>
</html>
