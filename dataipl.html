<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Tampilkan Data Google Sheets</title>
</head>
<body>
  <h2>Data dari Google Sheets</h2>
  <table id="data-table" border="1" cellpadding="5" cellspacing="0">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    // URL CSV publik Google Sheets
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRQBSWp7dBKus6wO8G-vBtSW9ZpKlRbmNLbXsaWQZeaQU_ZEY9p9EujIGTyIPVzb5cgVTlq9d0Lf29P/pub?gid=186945041&single=true&output=csv';

    // Fungsi parse CSV sederhana ke array
    function parseCSV(text) {
      const lines = text.trim().split('\n');
      return lines.map(line => line.split(','));
    }

    // Render tabel dari array data
    function renderTable(data) {
      const thead = document.querySelector('#data-table thead');
      const tbody = document.querySelector('#data-table tbody');
      
      // Clear table dulu
      thead.innerHTML = '';
      tbody.innerHTML = '';

      // Header (baris pertama)
      const headerRow = document.createElement('tr');
      data[0].forEach(headerText => {
        const th = document.createElement('th');
        th.textContent = headerText;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      // Body (data baris berikutnya)
      for (let i = 1; i < data.length; i++) {
        const row = document.createElement('tr');
        data[i].forEach(cellText => {
          const td = document.createElement('td');
          td.textContent = cellText;
          row.appendChild(td);
        });
        tbody.appendChild(row);
      }
    }

    // Ambil data CSV dan tampilkan
    fetch(csvUrl)
      .then(response => response.text())
      .then(text => {
        const data = parseCSV(text);
        renderTable(data);
      })
      .catch(err => {
        console.error('Gagal ambil data:', err);
        document.body.innerHTML += '<p>Gagal mengambil data.</p>';
      });
  </script>
</body>
</html>
